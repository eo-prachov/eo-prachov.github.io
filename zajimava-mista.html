<!DOCTYPE html>
<html lang="cs">
<head>
    <title>Zajímavá místa v okolí | Eko-Oáza Prachov</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Tipy na výlety v okolí Eko-Oázy Prachov.">
    <link rel="canonical" href="https://www.example.com/zajimava-mista.html">
    <style>
        :root{--primary-blue:#007bff;--text-color:#333;--background-color:#fff;--container-bg:#2570b8}
        *, *:before, *:after { box-sizing: border-box; }
        body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;background-color:var(--container-bg);color:var(--text-color);margin:0;padding:0;display:flex;justify-content:center;font-size:18px;line-height:1.6}
        
        .container{
            background-color:var(--background-color);
            width:100%;
            max-width:960px;
            margin:20px;
            padding:20px;
            box-shadow:0 0 15px rgba(0,0,0,.2); 
            display: flex;
            flex-direction: column;
        }

        header{padding:20px 0;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;background-color:var(--background-color);z-index:100;border-bottom:1px solid #eee;box-shadow:0 2px 5px rgba(0,0,0,.05)}
        header h1{margin:0;font-size:28px}
        header h1 a{text-decoration:none;color:var(--text-color);cursor:pointer}
        nav a{margin-left:15px;text-decoration:none;color:var(--primary-blue);font-weight:700;cursor:pointer}
        nav a:hover{text-decoration:underline}
        
        .gallery{display:flex;flex-wrap:wrap;gap:10px;margin:20px 0}
        .gallery img{flex:1 1 200px;max-width:23.5%;height:auto;object-fit:cover;cursor:pointer;transition:transform .2s ease-in-out,box-shadow .2s;display:block}
        
        #admin-toolbar{display:none;position:fixed;top:0;left:0;width:100%;background:#2c3e50;color:#fff;padding:10px;z-index:9999;text-align:center;}
        #admin-toolbar button{background:#3498db;color:#fff;border:none;padding:8px 15px;cursor:pointer;margin:5px;}
        .editable-text[contenteditable=true]{outline:2px dashed #3498db}
        #login-modal{display:none;position:fixed;z-index:10001;left:0;top:0;width:100%;height:100%;background-color:rgba(0,0,0,.6)}

        @media screen and (max-width:768px){
            header{flex-direction:column;align-items:flex-start;}
            nav{display:flex;justify-content:space-around;width:100%}
        }
    </style>
</head>
<body>
    <div id="admin-toolbar">
        <span>Režim úprav</span>
        <button id="save-btn" onclick="saveAllChanges()">Uložit změny</button>
        <button id="logout-btn" onclick="logout()">Odhlásit se</button>
    </div>
    <div id="login-modal">
        <form onsubmit="handleLogin(event)">
            <h2>Admin Login</h2>
            <input type="email" id="email" value="admin@e-o-p.cz" required>
            <input type="password" id="password" required>
            <button type="submit">Přihlásit se</button>
        </form>
    </div>

    <div class="container">
        <header>
            <h1><a onclick="goHome()">Eko-Oáza Prachov</a></h1>
            <nav id="nav-cs">
                <a href="index.html">Úvod</a>
                <a href="provozni-rad.html">Provozní řád</a>
                <a onclick="switchLanguage('en')">English version</a>
            </nav>
            <nav id="nav-en" style="display:none;">
                <a href="index.html?lang=en">Home</a>
                <a href="provozni-rad.html?lang=en">Operating rules</a>
                <a onclick="switchLanguage('cs')">Česká verze</a>
            </nav>
        </header>

        <main id="main-content">
            <div id="lang-cs">
                 <div class="editable-text" data-field="cs-places-intro"></div>
                 <div class="gallery">
                    <img src="obrazky/12.png"><img src="obrazky/13.png"><img src="obrazky/14.png">
                 </div>
            </div>
            <div id="lang-en" style="display:none;">
                 <div class="editable-text" data-field="en-places-intro"></div>
                 <div class="gallery">
                    <img src="obrazky/12.png"><img src="obrazky/13.png"><img src="obrazky/14.png">
                 </div>
            </div>
        </main>
    </div>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    
    <script id="main-script">
        const firebaseConfig = { apiKey: "AIzaSyCuI9hhPtQMDkNqlQmmPfJRMWZWZFrT3hw", authDomain: "eko-oaza-website.firebaseapp.com", projectId: "eko-oaza-website", storageBucket: "eko-oaza-website.firebasestorage.app", messagingSenderId: "32000760259", appId: "1:32000760259:web:b6b797ca91de9bd7688576", measurementId: "G-0KLWHCEM16" };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth(), db = firebase.firestore();
        let isAdmin = false, unsavedChanges = false, dbInterval = null;

        function goHome() {
            if(checkUnsavedChanges()) {
                window.location.href = `index.html?lang=${document.documentElement.lang}`;
            }
        }

        auth.onAuthStateChanged(user => { 
            isAdmin = !!user; 
            if (isAdmin) { 
                document.getElementById('admin-toolbar').style.display = 'block'; 
                document.querySelectorAll('.editable-text').forEach(el => el.contentEditable = true);
                if(dbInterval) clearInterval(dbInterval);
            } else {
                fetchFromDB();
                if(!dbInterval) dbInterval = setInterval(() => { if(!isAdmin) fetchFromDB(); }, 10000);
            }
        });

        async function fetchFromDB() {
            if (isAdmin) return;
            const docId = `zajimava-mista_${document.documentElement.lang}`;
            const doc = await db.collection('content').doc(docId).get();
            if (doc.exists) {
                Object.keys(doc.data()).forEach(id => {
                    let el = document.querySelector(`[data-field="${id}"]`);
                    if (el) el.innerHTML = doc.data()[id];
                });
            }
        }

        async function saveAllChanges() {
            const promises = [];
            document.querySelectorAll('.editable-text').forEach(el => {
                const docId = `zajimava-mista_${el.dataset.field.startsWith('cs') ? 'cs' : 'en'}`;
                promises.push(db.collection('content').doc(docId).set({ [el.dataset.field]: el.innerHTML }, { merge: true }));
            });
            await Promise.all(promises);
            alert('Uloženo!');
            unsavedChanges = false;
        }

        function switchLanguage(lang) { 
            const params = new URLSearchParams(window.location.search);
            params.set('lang', lang);
            window.location.search = params.toString();
        }

        function checkUnsavedChanges() { if (unsavedChanges) return confirm("Neuloženo!"); return true; }
        document.addEventListener('DOMContentLoaded', () => { 
            const lang = new URLSearchParams(window.location.search).get('lang') || 'cs';
            document.documentElement.lang = lang;
            document.getElementById('lang-cs').style.display = lang === 'cs' ? 'block' : 'none';
            document.getElementById('lang-en').style.display = lang === 'en' ? 'block' : 'none';
            fetchFromDB();
        });
    </script>
</body>
</html>